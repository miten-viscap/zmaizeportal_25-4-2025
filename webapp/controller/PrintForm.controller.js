sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/core/UIComponent","sap/m/PDFViewer","sap/m/MessageBox","sap/ui/core/BusyIndicator"],function(e,t,s,a,r,o){"use strict";var n;return e.extend("MaizeProcurementPortal.MaizeProcurementPortal.controller.PrintForm",{onInit:function(){var e="/sap/opu/odata/sap/ZGW_GATEPASS_SRV/";n=new sap.ui.model.odata.ODataModel(e);this.getView().setModel(n);this._pdfViewer=new a;this.getView().addDependent(this._pdfViewer)},onNavBack:function(){var e=s.getRouterFor(this);e.navTo("Dashboard");this.getView().byId("gp_num").setValue("");this.byId("gp_num").setValueState("None")},validateGPNum:function(e){let t=e.getSource();let s=t.getSelectedKey();let a=t.getValue()},NumbValid:function(){var e="^[0-9]{10}$";var t=this.byId("gp_num").getValue();if(!t.match(e)){this.getView().byId("gp_num").setValueState("Error")}else{this.getView().byId("gp_num").setValueState("None")}},fnPrintGatePass:async function(e){let t=this.getView().byId("gp_num");let s=this.getView().byId("gp_num_to");let a=t.getValueState();let n=t.getValue();let i=s.getValue();let u=[];let l="GATEPASS";var m=this;if(a!=="None"||!n){r.error("'Gate Pass From' is Mandatory, Enter correct Gate Pass number.");return}if(n&&i){let e=parseInt(n);let t=parseInt(i);let s=[];u=this._generateSequence(e,t);o.show();for(let e=0;e<u.length;e++){s.push(m._printGpPromise(u[e],l))}await Promise.all(s).then(e=>{console.log(e);o.hide()})}else if(n){let e=[];u=[n];o.show();for(let t=0;t<u.length;t++){e.push(m._printGpPromise(u[t],l))}await Promise.all(e).then(e=>{console.log(e);o.hide()})}},_printGpPromise:function(e,t){var s=this;return new Promise(async function(s,a){n.read("/SmartformSet(Gpassno='"+e+"',Formname='"+t+"')/$value",{method:"GET",success:function(e,t){var a=t.requestUri;window.open(a);s(true)},error:function(e,t){sap.m.MessageToast.show("Somthing is wrong. Please contact your Backend Administrator");s(false)}})})},_printVoucherPromise:function(e,t){var s=this;return new Promise(async function(s,a){n.read("/SmartformSet(Gpassno='"+e+"',Formname='"+t+"')/$value",{method:"GET",success:function(e,t){var a=t.requestUri;window.open(a);s(true)},error:function(e,t){sap.m.MessageToast.show("Somthing is wrong. Please contact your Backend Administrator");s(false)}})})},fnPrintVoucher:async function(){let e=this.getView().byId("gp_num");let t=this.getView().byId("gp_num_to");let s=e.getValueState();let a=e.getValue();let n=t.getValue();let i=[];let u="PAYMENT";var l=this;if(s!=="None"||!a){r.error("'Gate Pass From' is Mandatory, Enter correct Gate Pass number.");return}if(a&&n){let e=parseInt(a);let t=parseInt(n);let s=[];i=this._generateSequence(e,t);for(let e=0;e<i.length;e++){s.push(l._printVoucherPromise(i[e],u))}await Promise.all(s).then(e=>{console.log(e);o.hide()})}else if(a){let e=[];i=[a];o.show();for(let t=0;t<i.length;t++){e.push(l._printVoucherPromise(i[t],u))}await Promise.all(e).then(e=>{console.log(e);o.hide()})}},_generateSequence:function(e,t){let s=[];for(let a=e;a<=t;a++){s.push(a.toString())}return s},printGP:function(){var e=this;var t=this.byId("gp_num").getValue();var s="GATEPASS";var a="^[0-9]{10}$";if(!t.match(a)){this.getView().byId("gp_num").setValueState("Error");sap.m.MessageToast.show("Gate Pass No. must be 10 digit without any Characters")}else{this.getView().byId("gp_num").setValueState("None");if(t==""){sap.m.MessageToast.show("Gate Passs Number is Mandatory")}else{n.read("/SmartformSet(Gpassno='"+t+"',Formname='"+s+"')/$value",{method:"GET",success:function(t,s){var a=s.requestUri;e._pdfViewer.setSource(a);e._pdfViewer.setTitle("Gate Pass Form");e._pdfViewer.open()},error:function(e,t){sap.m.MessageToast.show("Somthing is wrong. Please contact your Backend Administrator")}})}}},printVoucher:function(){var e=this;var t=this.byId("gp_num").getValue();var s="PAYMENT";var a="^[0-9]{10}$";if(!t.match(a)){this.getView().byId("gp_num").setValueState("Error");sap.m.MessageToast.show("Gate Pass No. must be 10 digit without any Characters")}else{this.getView().byId("gp_num").setValueState("None");if(t==""){sap.m.MessageToast.show("Gate Passs Number is Mandatory")}else{n.read("/SmartformSet(Gpassno='"+t+"',Formname='"+s+"')",{method:"GET",success:function(a,r){var o=r.requestUri;var i=a.Message;if(i==""){n.read("/SmartformSet(Gpassno='"+t+"',Formname='"+s+"')/$value",{method:"GET",success:function(t,s){var a=s.requestUri;e._pdfViewer.setSource(a);e._pdfViewer.setTitle("Payment Requisition Slip");e._pdfViewer.open()},error:function(e,t){sap.m.MessageToast.show("Somthing is wrong. Please contact your Backend Administrator")}})}else{sap.m.MessageToast.show(i)}},error:function(e,t){sap.m.MessageToast.show("Somthing is wrong. Please contact your Backend Administrator")}})}}}})});
//# sourceMappingURL=PrintForm.controller.js.map